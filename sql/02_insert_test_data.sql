-- Файл: sql/02_insert_test_data.sql
-- Наполнение БД тестовыми данными для демонстрации аналитических запросов

USE cnbp_production_db;

-- Проекты
INSERT INTO Projects (project_name, client_name, start_date, deadline, status) VALUES
('Заказ №245-24', 'ООО "Проммаш"', '2024-05-10', '2024-06-20', 'В работе'),
('Заказ №301-24', 'АО "Металлист"', '2024-05-15', '2024-07-01', 'В работе');

-- Изделия
INSERT INTO Products (product_name, drawing_number, specification, project_id) VALUES
('Вал-шестерня', 'ВШ-102-24', 'Сталь 45, HRC 42-48', 1),
('Корпус редуктора', 'КР-045-24', 'Чугун СЧ20', 1),
('Крышка подшипника', 'КП-208-24', 'Алюминий АК7', 2),
('Шкив клиноремённый', 'ШК-176-24', 'Сталь 20', 2);

-- Операции
INSERT INTO Operations (operation_name, operation_code, standard_time, required_qualification) VALUES
('Токарная обработка черновая', 'ТОК-01', 1.5, 'Токарь 4 разряда'),
('Токарная обработка чистовая', 'ТОК-02', 2.0, 'Токарь 5 разряда'),
('Фрезерование шпоночного паза', 'ФР-07', 1.0, 'Фрезеровщик 4 разряда'),
('Сверлильная', 'СВ-03', 0.5, 'Сверловщик 3 разряда'),
('Контроль качества', 'ОТК-01', 0.3, 'Контролёр');

-- Оборудование
INSERT INTO Machines (machine_name, inventory_number, manufacture_year, machine_type, status) VALUES
('Токарный станок 1К62', 'Т-101', 2015, 'Токарный', 'Исправен'),
('Токарный станок 16К20', 'Т-102', 2018, 'Токарный', 'Исправен'),
('Фрезерный станок 6Р13', 'Ф-205', 2016, 'Фрезерный', 'Исправен'),
('Сверлильный станок 2Н135', 'С-310', 2014, 'Сверлильный', 'Ремонт');

-- Сотрудники
INSERT INTO Employees (full_name, position, qualification, hire_date, department, email) VALUES
('Иванов А.С.', 'Токарь', '5 разряд', '2018-04-12', 'Механический цех', 'ivanov@cnbp.ru'),
('Петров В.И.', 'Токарь', '4 разряд', '2020-09-01', 'Механический цех', 'petrov@cnbp.ru'),
('Сидоров Н.П.', 'Фрезеровщик', '4 разряд', '2019-11-20', 'Механический цех', 'sidorov@cnbp.ru'),
('Козлова Е.А.', 'Контролёр', '3 разряд', '2021-02-15', 'ОТК', 'kozlova@cnbp.ru'),
('Смирнов Д.С.', 'Наладчик', '6 разряд', '2017-05-30', 'РМЦ', 'smirnov@cnbp.ru');

-- Материалы
INSERT INTO Materials (material_name, material_type, unit_of_measure, unit_price, current_stock, min_stock_level) VALUES
('Сталь 45', 'Металл', 'кг', 120.00, 500, 100),
('Чугун СЧ20', 'Металл', 'кг', 95.00, 300, 50),
('Алюминий АК7', 'Цветной металл', 'кг', 250.00, 150, 30);

-- Связь изделий и материалов (нормы расхода)
INSERT INTO Product_Materials (product_id, material_id, quantity_required) VALUES
(1, 1, 2.5),   -- Вал-шестерня: 2.5 кг Стали 45
(2, 2, 8.0),   -- Корпус редуктора: 8 кг Чугуна СЧ20
(3, 3, 1.2),   -- Крышка подшипника: 1.2 кг Алюминия
(4, 1, 3.0);   -- Шкив: 3 кг Стали 45

-- Журнал производства (15 записей)
INSERT INTO ProductionLog (project_id, product_id, operation_id, machine_id, employee_id, material_id, 
                           start_time, end_time, quantity_produced, defects_count, notes) VALUES
(1, 1, 1, 1, 2, 1, '2024-05-20 08:00:00', '2024-05-20 10:30:00', 10, 1, 'Черновая обработка'),
(1, 1, 2, 2, 1, 1, '2024-05-20 11:00:00', '2024-05-20 13:30:00', 8, 0, 'Чистовая обработка'),
(1, 1, 5, NULL, 4, NULL, '2024-05-20 14:00:00', '2024-05-20 14:20:00', 8, 2, 'Контроль'),
(1, 2, 3, 3, 3, 2, '2024-05-21 08:30:00', '2024-05-21 10:00:00', 5, 0, 'Фрезеровка'),
(1, 2, 4, 4, 3, 2, '2024-05-21 10:30:00', '2024-05-21 11:15:00', 5, 1, 'Сверление'),
(2, 3, 1, 1, 2, 3, '2024-05-22 09:00:00', '2024-05-22 11:30:00', 15, 2, 'Токарная'),
(2, 3, 2, 2, 1, 3, '2024-05-22 12:00:00', '2024-05-22 14:30:00', 12, 1, 'Чистовая'),
(2, 3, 5, NULL, 4, NULL, '2024-05-22 15:00:00', '2024-05-22 15:20:00', 12, 1, 'Контроль'),
(2, 4, 1, 1, 2, 1, '2024-05-23 08:00:00', '2024-05-23 10:30:00', 20, 3, 'Токарная'),
(2, 4, 2, 2, 1, 1, '2024-05-23 11:00:00', '2024-05-23 13:30:00', 18, 2, 'Чистовая'),
(2, 4, 3, 3, 3, 1, '2024-05-23 14:00:00', '2024-05-23 15:30:00', 16, 0, 'Фрезеровка'),
(2, 4, 5, NULL, 4, NULL, '2024-05-23 16:00:00', '2024-05-23 16:25:00', 16, 4, 'Контроль'),
(1, 1, 1, 1, 2, 1, '2024-05-24 08:00:00', '2024-05-24 10:15:00', 12, 0, 'Повторная партия'),
(1, 1, 2, 2, 1, 1, '2024-05-24 11:00:00', '2024-05-24 13:20:00', 10, 1, 'Чистовая'),
(1, 1, 5, NULL, 4, NULL, '2024-05-24 14:00:00', '2024-05-24 14:18:00', 10, 1, 'Контроль');
